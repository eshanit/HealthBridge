[program:healthbridge-couchdb-sync]
; UtanoBridge CouchDB to MySQL Sync Worker
; This worker continuously syncs changes from CouchDB to MySQL
process_name=%(program_name)s_%(process_num)02d
command=php %(ENV_PROJECT_PATH)s/artisan couchdb:sync --daemon --poll=4 --batch=100

; Run as the web server user (adjust for your system)
user=www-data
group=www-data

; Auto-start and auto-restart
autostart=true
autorestart=true

; Restart on unexpected exit
startsecs=1
stopwaitsecs=10

; Logging
stdout_logfile=%(ENV_PROJECT_PATH)s/storage/logs/couchdb-sync.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile=%(ENV_PROJECT_PATH)s/storage/logs/couchdb-sync-error.log
stderr_logfile_maxbytes=10MB
stderr_logfile_backups=5

; Environment variables
environment=APP_ENV="production"

; Number of worker instances (typically 1 for CouchDB sync to avoid conflicts)
numprocs=1

; Priority (lower = higher priority)
priority=999

; Stop signal
stopsignal=SIGTERM

; Redirect stderr to stdout
redirect_stderr=false
